<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Poler SMS</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <!-- Chart.js Library -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        :root {
            --primary: #6a11cb;
            --secondary: #2575fc;
            --accent: #ff5e62;
            --dark: #2d3436;
            --light: #f5f6fa;
            --success: #38ef7d;
            --warning: #f6d365;
            --danger: #f857a6;
            --body-bg: linear-gradient(135deg, #f5f7fa 0%, #dfe6e9 100%);
            --component-bg: #ffffff;
            --text-color: var(--dark);
            --border-color: #e0e0e0;
            --shadow-color: rgba(0, 0, 0, 0.1);
            --input-bg: #fdfdfd;
            --table-header-bg: #f1f3f5;
            --login-box-bg: rgba(255, 255, 255, 0.95);
        }

        body.dark-mode {
            --primary: #7c37ff;
            --secondary: #4a8dff;
            --accent: #ff7e82;
            --dark: #e4e6eb; /* Light text for dark mode */
            --light: #18191a; /* Dark background for dark mode */
            --success: #45f79a;
            --warning: #f8d879;
            --danger: #fa7aa6;
            --body-bg: #121212;
            --component-bg: #242526;
            --text-color: #e4e6eb;
            --border-color: #3a3b3c;
            --shadow-color: rgba(0, 0, 0, 0.4);
            --input-bg: #3a3b3c;
            --table-header-bg: #303132;
            --login-box-bg: rgba(36, 37, 38, 0.95);
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Poppins', sans-serif;
        }
        
        html, body {
            height: 100%;
            margin: 0;
            padding: 0;
        }

        body {
            background: var(--body-bg);
            color: var(--text-color);
            min-height: 100vh;
            display: flex; /* Make body a flex container */
            flex-direction: column; /* Stack children vertically */
            transition: background-color 0.3s, color 0.3s;
        }
        
        .container {
            display: none;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            position: relative;
        }
        
        /* Premium Login Page */
        #login-container {
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            background: var(--body-bg);
            background-size: cover;
            background-position: center center;
            background-repeat: no-repeat;
            background-attachment: fixed;
            animation: none;
            flex-grow: 1; /* Allow it to grow and fill space */
        }
        
        .login-box {
            background: var(--login-box-bg);
            padding: 0;
            border-radius: 15px;
            box-shadow: 0 10px 30px var(--shadow-color);
            width: 100%;
            max-width: 400px;
            text-align: center;
            transform: translateY(-20px);
            transition: all 0.3s ease;
            animation: fadeInUp 0.8s ease-out;
            overflow: hidden;
            border: 1px solid var(--border-color);
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(50px);
            }
            to {
                opacity: 1;
                transform: translateY(-20px);
            }
        }
        
        .login-box:hover {
            transform: translateY(-25px);
            box-shadow: 0 15px 35px var(--shadow-color);
        }

        .login-box-header {
            background: #5d4a66;
            padding: 30px 20px 60px 20px;
            position: relative;
            color: white;
            border-top-left-radius: 15px;
            border-top-right-radius: 15px;
            box-shadow: inset 0 -5px 10px rgba(0,0,0,0.2);
        }

        .login-box-header .poler-sms-logo-small {
            width: 50px;
            height: auto;
            display: inline-block;
            vertical-align: middle;
            margin-right: 10px;
        }
        
        .login-box-header .welcome-text {
            font-size: 14px;
            margin-bottom: 5px;
            opacity: 0.8;
        }

        .login-box-header h2 {
            font-size: 24px;
            font-weight: 600;
            color: white;
            margin: 0;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.3);
        }

        .lock-icon-circle {
            background: var(--component-bg);
            color: #5d4a66;
            width: 70px;
            height: 70px;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 30px;
            box-shadow: 0 3px 10px rgba(0,0,0,0.15);
            position: absolute;
            bottom: -35px;
            left: 50%;
            transform: translateX(-50%);
            border: 2px solid #a8a8a8;
            z-index: 1;
        }

        .login-box-body {
            background: var(--component-bg);
            padding: 50px 30px 30px 30px;
            border-bottom-left-radius: 15px;
            border-bottom-right-radius: 15px;
            position: relative;
        }
        
        .login-box-body input {
            width: 100%;
            padding: 15px;
            margin-bottom: 15px;
            border: 1px solid var(--border-color);
            border-radius: 5px;
            font-size: 16px;
            transition: all 0.3s;
            background: var(--input-bg);
            color: var(--text-color);
            box-shadow: inset 0 1px 3px rgba(0, 0, 0, 0.05);
        }
        
        .login-box-body input::placeholder {
            color: #b0b0b0;
        }

        .login-box-body input:focus {
            border-color: #a0a0a0;
            box-shadow: 0 0 0 2px rgba(160, 160, 160, 0.3), inset 0 1px 3px rgba(0, 0, 0, 0.05);
            background: var(--component-bg);
            outline: none;
        }

        .keep-logged-in {
            text-align: left;
            margin-bottom: 20px;
            font-size: 14px;
            color: var(--text-color);
            display: flex;
            align-items: center;
        }
        .keep-logged-in input[type="checkbox"] {
            width: auto;
            height: auto;
            margin-right: 8px;
            flex-shrink: 0;
            accent-color: #666;
            border-color: #888;
            outline: none;
        }
        .keep-logged-in label {
            margin: 0;
            font-size: 14px;
            font-weight: 400;
            cursor: pointer;
        }
        
        .captcha {
            margin: 20px 0;
            font-size: 18px;
            font-weight: 600;
            color: var(--text-color);
            background: var(--input-bg);
            padding: 10px;
            border-radius: 5px;
            border: 1px solid var(--border-color);
            text-shadow: none;
        }

        .login-box button {
            width: 100%;
            padding: 14px;
            background: #5d4a66;
            color: white;
            border: none;
            border-radius: 5px;
            font-size: 16px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s ease-in-out;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
            letter-spacing: 0.5px;
            text-transform: uppercase;
        }
        
        .login-box button:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.25);
            background: #7a6684;
        }
        
        .error-support-message {
            background-color: #ffebeb;
            border: 1px solid var(--danger);
            border-radius: 8px;
            padding: 15px;
            margin-top: 20px;
            text-align: center;
            color: var(--danger);
            font-weight: 500;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 10px;
            animation: fadeIn 0.5s ease-out;
        }
        body.dark-mode .error-support-message {
            background-color: rgba(248, 87, 166, 0.1);
        }

        .error-support-message p {
            margin: 0;
            font-size: 15px;
            display: flex;
            align-items: center;
        }

        .error-support-message p i {
            margin-right: 8px;
            color: var(--danger);
        }

        .error-support-message a {
            background-color: #4267B2;
            color: white;
            padding: 8px 15px;
            border-radius: 5px;
            text-decoration: none;
            font-weight: 600;
            transition: background-color 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .error-support-message a:hover {
            background-color: #365899;
        }

        .support-login-link {
            margin-top: 30px;
            text-align: center;
            font-size: 15px;
            color: var(--text-color);
            padding-top: 20px;
            border-top: 1px solid var(--border-color);
        }
        
        .support-login-link a {
            color: var(--secondary);
            text-decoration: none;
            font-weight: 600;
            transition: color 0.3s ease;
        }
        
        .support-login-link a:hover {
            color: var(--primary);
            text-decoration: underline;
        }
        
        .support-login-link i {
            margin-right: 8px;
            font-size: 16px;
        }
        
        /* Menu Button */
        .menu-toggle {
            position: fixed;
            top: 20px;
            left: 20px;
            z-index: 1001; 
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            display: none; 
            justify-content: center;
            align-items: center;
            cursor: pointer;
            box-shadow: 0 4px 15px var(--shadow-color);
            transition: all 0.3s;
            border: none;
            font-size: 20px;
        }
        
        .menu-toggle:hover {
            transform: scale(1.1);
            box-shadow: 0 7px 20px var(--shadow-color);
        }
        
        /* Sidebar Styles */
        .sidebar {
            position: fixed;
            top: 0;
            left: -300px;
            width: 250px;
            height: 100vh;
            background: linear-gradient(135deg, #1e3c72, #2a5298);
            box-shadow: 5px 0 15px rgba(0, 0, 0, 0.2);
            transition: all 0.3s ease;
            z-index: 1000;
            padding: 20px;
            color: white;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
        }

        body.dark-mode .sidebar {
            background: linear-gradient(135deg, #1a202c, #2d3748);
        }
        
        .sidebar.active {
            left: 0;
        }

        .user-profile-frame {
            background: rgba(255, 255, 255, 0.05);
            padding: 15px;
            border-radius: 8px;
            text-align: left;
            margin-top: 50px;
            margin-bottom: 25px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        .profile-top-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 5px;
        }
        .user-profile-frame h4 {
            margin: 0;
            font-weight: 600;
            font-size: 18px;
            color: #fff;
        }
        .panel-tag {
            background-color: rgba(37, 117, 252, 0.7);
            color: #fff;
            padding: 2px 8px;
            border-radius: 4px;
            font-size: 10px;
            font-weight: 600;
            text-transform: uppercase;
        }
        .user-profile-frame p {
            margin: 0;
            font-size: 13px;
            color: rgba(255, 255, 255, 0.7);
            font-weight: 500;
        }
        
        .sidebar h3 {
            color: #fff;
            margin-bottom: 25px;
            padding-bottom: 10px;
            border-bottom: 2px solid rgba(255, 255, 255, 0.2);
            font-size: 20px;
            font-weight: 500;
        }
        
        .sidebar ul {
            list-style: none;
            padding: 0;
            margin: 0;
            flex-grow: 1;
            display: flex;
            flex-direction: column;
        }
        
        .sidebar li {
            margin-bottom: 10px;
            padding: 12px 15px;
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            position: relative;
        }
        
        .sidebar li::before {
            content: '';
            position: absolute;
            left: 0;
            top: 0;
            width: 3px;
            height: 100%;
            background: var(--accent);
            opacity: 0;
            transition: all 0.3s;
        }
        
        .sidebar li.active::before {
            opacity: 1;
        }
        
        .sidebar li i {
            margin-right: 10px;
            font-size: 18px;
            color: rgba(255, 255, 255, 0.7);
        }
        
        .sidebar li:hover, .sidebar li.active {
            background: rgba(255, 255, 255, 0.1);
            transform: translateX(5px);
        }
        
        .sidebar li.active {
            background: rgba(255, 255, 255, 0.15);
        }
        
        .sidebar li.active i {
            color: white;
        }
        
        .sidebar li.sign-out {
            margin-top: auto;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            padding-top: 20px;
            color: var(--accent);
            margin-bottom: 10px;
        }
        
        .sidebar li.sign-out i {
            color: var(--accent);
        }

        /* --- Dark Mode Toggle --- */
        .theme-switch-wrapper {
            display: flex;
            align-items: center;
            margin: 20px 0;
            padding: 10px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 8px;
        }
        .theme-switch-wrapper span {
            margin-left: 10px;
            font-size: 14px;
            font-weight: 500;
            color: #fff;
        }
        .theme-switch {
            position: relative;
            display: inline-block;
            width: 50px;
            height: 26px;
        }
        .theme-switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }
        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #4c566a;
            transition: .4s;
            border-radius: 26px;
        }
        .slider:before {
            position: absolute;
            content: "";
            height: 20px;
            width: 20px;
            left: 3px;
            bottom: 3px;
            background-color: white;
            transition: .4s;
            border-radius: 50%;
            background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" height="16" width="16" viewBox="0 0 512 512"><path fill="orange" d="M361.5 1.2c-11.4 1.5-20.1 10.3-21.7 21.7l-32.5 213.9L256 224l-51.3 12.9L172.2 22.9C170.6 11.4 161.9 2.7 150.5 1.2S126.6-1.5 119 4.2L2.3 80.8c-7.5 5.7-10.8 15.6-8.2 24.9l52.3 186.2-186.2 52.3c-9.4 2.6-16.2 10-18.9 19.5s-1.4 20.3 5.4 27.5l75.5 79.5c6.9 7.3 17.5 9.4 27.2 5.5l194.8-82.5 82.5 194.8c3.9 9.7 14.1 15.7 24.9 14.2l126.3-17.9c9.4-1.3 17.6-6.7 22.8-14.3s7.3-17.1 5.3-26.4l-76.3-174.4 174.4-76.3c9.3-2 16.5-7.8 21.3-15.9s7.1-18.5 4.3-27.4L431.2 19.5c-2.8-8.9-9.5-15.6-18.4-18.4l-1.5-.4z"/></svg>');
            background-repeat: no-repeat;
            background-position: center;
        }
        input:checked + .slider {
            background-color: #2196F3;
        }
        input:checked + .slider:before {
            transform: translateX(24px);
            background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" height="16" width="16" viewBox="0 0 384 512"><path fill="yellow" d="M223.5 32C100 32 0 132.3 0 256S100 480 223.5 480c60.6 0 115.5-24.2 155.8-63.4c5-4.9 6.3-12.5 3.1-18.7s-10.1-9.7-17-8.5c-9.8 1.7-20 2.6-30.6 2.6c-96.9 0-175.5-78.8-175.5-176c0-65.8 36-123.1 89.3-153.3c6.1-3.5 9.2-10.5 7.7-17.3s-7.3-11.9-14.3-12.5c-6.3-.5-12.6-.8-19-.8z"/></svg>');
            background-repeat: no-repeat;
            background-position: center;
        }


        /* Social Support Links (Framed Style) */
        .sidebar li.social-support-link {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 8px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
            margin-bottom: 15px;
            padding: 12px 15px;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            position: relative;
        }

        .sidebar li.social-support-link a {
            font-size: 16px;
            font-weight: 500;
            color: white;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.2);
            text-decoration: none;
            display: flex;
            align-items: center;
            width: 100%;
        }

        .sidebar li.social-support-link i {
            font-size: 20px;
            color: var(--secondary);
            transition: color 0.3s ease;
            margin-right: 10px;
        }

        .sidebar li.social-support-link:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: translateX(3px);
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
        }

        .sidebar li.social-support-link:hover i {
            color: var(--accent);
        }

        .sidebar li.social-support-link::before {
            content: '';
            position: absolute;
            left: 0;
            top: 0;
            width: 3px;
            height: 100%;
            background: var(--primary);
            opacity: 0;
            transition: all 0.3s;
        }
        .sidebar li.social-support-link:hover::before {
            opacity: 1;
        }
        
        /* Main Content & Shift Logic */
        .main-content {
            transition: margin-left 0.3s ease;
            flex-grow: 1; /* Allow it to grow and fill space */
        }

        .main-content.shifted {
            margin-left: 250px;
        }

        /* --- HEADER STYLES --- */
        .header {
            display: flex;
            align-items: center;
            margin-bottom: 30px;
            padding-bottom: 15px;
            border-bottom: 1px solid var(--border-color);
            position: relative;
            min-height: 40px;
        }
        
        .header h1 {
            font-size: 28px;
            font-weight: 600;
            background: linear-gradient(to right, var(--primary), var(--secondary));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin: 0;
            position: absolute;
            left: 50%;
            transform: translateX(-50%);
        }

        /* Specific style for the main Dashboard header */
        #dashboard-container .header {
            justify-content: flex-start; 
            padding-left: 60px; 
        }
        #dashboard-container .header h1 {
            position: static;
            transform: none;
            font-size: 32px;
        }

        /* --- MODIFIED: Back to Dashboard Button --- */
        .back-to-dashboard {
            margin-left: auto; 
            padding: 6px 12px; 
            font-size: 13px; 
            gap: 5px; 

            background: var(--input-bg);
            border: 1px solid var(--border-color);
            border-radius: 20px;
            cursor: pointer;
            font-weight: 500;
            display: flex;
            align-items: center;
            transition: all 0.3s;
            z-index: 1; 
            color: var(--text-color);
        }

        .back-to-dashboard:hover {
            background: #e0e0e0;
            box-shadow: 0 2px 5px var(--shadow-color);
        }
        body.dark-mode .back-to-dashboard:hover {
             background: #4a4b4c;
        }
        
        .dashboard-title {
            margin-bottom: 20px;
            font-size: 24px;
            font-weight: 600;
            background: linear-gradient(to right, var(--primary), var(--secondary));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            display: inline-block;
        }
        
        /* UPDATED: Nav Buttons Container */
        .nav-buttons-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 25px;
            margin-bottom: 40px;
            padding: 20px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 15px;
            box-shadow: 0 8px 25px var(--shadow-color);
            border: 1px solid var(--border-color);
        }
        
        /* UPDATED: Nav Button Styling */
        .nav-button {
            background: var(--component-bg);
            padding: 30px 20px;
            border-radius: 12px;
            box-shadow: 0 8px 20px var(--shadow-color);
            text-align: center;
            transition: all 0.4s ease-in-out;
            border: 1px solid var(--border-color);
            cursor: pointer;
            position: relative;
            overflow: hidden;
        }
        
        .nav-button:hover {
            transform: translateY(-8px) scale(1.03);
            box-shadow: 0 15px 35px var(--shadow-color), 
                        0 0 0 3px var(--primary);
        }
        
        .nav-button i {
            font-size: 38px;
            margin-bottom: 15px;
            background: linear-gradient(to right, var(--primary), var(--secondary));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            transition: all 0.3s ease-in-out;
            filter: drop-shadow(1px 1px 1px rgba(0,0,0,0.1));
        }
        .nav-button:hover i {
            filter: drop-shadow(2px 2px 2px rgba(0,0,0,0.2));
        }
        
        .nav-button h3 {
            color: var(--text-color);
            font-size: 19px;
            font-weight: 600;
            margin: 0;
            transition: color 0.3s ease-in-out;
        }
        
        /* Live SMS Section */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Live SMS Container Styling */
        .live-sms-container {
            background: var(--component-bg);
            border-radius: 15px;
            box-shadow: 0 10px 30px var(--shadow-color);
            padding: 30px;
            margin-bottom: 30px;
            border: 1px solid var(--border-color);
            position: relative;
            overflow: hidden;
        }

        .live-sms-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid var(--border-color);
        }
        
        /* Live SMS Title with Logo */
        .live-sms-title {
            font-size: 22px;
            font-weight: 700;
            color: var(--text-color);
            background: linear-gradient(to right, var(--primary), var(--secondary));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        .live-sms-title .live-indicator {
            width: 10px;
            height: 10px;
            background-color: var(--danger);
            border-radius: 50%;
            animation: pulse 1.5s infinite;
        }
        @keyframes pulse {
            0% { box-shadow: 0 0 0 0 rgba(248, 87, 166, 0.7); }
            70% { box-shadow: 0 0 0 10px rgba(248, 87, 166, 0); }
            100% { box-shadow: 0 0 0 0 rgba(248, 87, 166, 0); }
        }

        .refresh-btn {
            background: linear-gradient(to right, var(--primary), var(--secondary));
            color: white;
            border: none;
            padding: 10px 18px;
            border-radius: 7px;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 15px;
            font-weight: 600;
            box-shadow: 0 4px 10px var(--shadow-color);
        }
        
        .refresh-btn:hover {
            transform: translateY(-3px) scale(1.02);
            box-shadow: 0 6px 15px var(--shadow-color);
        }
        
        .live-sms-list {
            max-height: 350px;
            overflow-y: auto;
            border-radius: 10px;
            border: 1px solid var(--border-color);
        }
        
        .sms-item {
            display: flex;
            align-items: center;
            gap: 15px;
            padding: 18px;
            border-bottom: 1px solid var(--border-color);
            animation: fadeIn 0.5s ease-in-out;
            background: var(--component-bg);
            transition: background-color 0.2s ease;
        }
        .sms-item:hover {
            background-color: rgba(0,0,0,0.1);
        }
        body.dark-mode .sms-item:hover {
            background-color: rgba(255,255,255,0.05);
        }
        .sms-item:last-child {
            border-bottom: none;
        }
        .sms-icon {
            font-size: 28px;
            width: 35px;
            text-align: center;
            flex-shrink: 0;
        }
        
        .sms-details {
            flex: 1;
        }

        .sms-number {
            font-weight: 700;
            color: var(--primary);
            margin-bottom: 5px;
            font-size: 16px;
        }
        
        .sms-content {
            color: var(--text-color);
            font-size: 15px;
        }
        
        .sms-time {
            color: #999;
            font-size: 13px;
            white-space: nowrap;
            flex-shrink: 0;
        }
        
        /* Stats & Chart Section */
        .stats-and-chart-container {
            display: grid;
            grid-template-columns: 1fr;
            gap: 30px;
            margin-bottom: 40px;
        }
        @media (min-width: 992px) {
            .stats-and-chart-container {
                grid-template-columns: 300px 1fr;
            }
        }
        .stats-grid {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }
        .stat-box {
            background: var(--component-bg);
            padding: 20px;
            border-radius: 12px;
            box-shadow: 0 5px 15px var(--shadow-color);
            display: flex;
            align-items: center;
            justify-content: space-between;
            border: 1px solid var(--border-color);
        }
        .stat-box-left {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        .stat-icon {
            background-color: var(--input-bg);
            width: 45px;
            height: 45px;
            border-radius: 8px;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 20px;
            color: var(--primary);
        }
        .stat-info h5 {
            font-size: 14px;
            color: #888;
            margin: 0 0 4px 0;
            font-weight: 500;
        }
        .stat-info p {
            font-size: 22px;
            font-weight: 600;
            color: var(--text-color);
            margin: 0;
        }
        .stat-trend i {
            font-size: 20px;
            color: var(--success);
        }
        .chart-container {
            background: var(--component-bg);
            padding: 25px;
            border-radius: 12px;
            box-shadow: 0 5px 15px var(--shadow-color);
            border: 1px solid var(--border-color);
        }
        
        /* Hide all containers by default */
        #sms-number-container,
        #sms-range-container,
        #sms-test-container,
        #deposit-container,
        #sms-reports-container {
            display: none;
        }
        
        /* SMS Test Panel Styles */
        .sms-test-wrapper {
            display: grid;
            grid-template-columns: 1fr 1.2fr;
            gap: 20px;
        }

        .test-panel {
            background: var(--component-bg); 
            padding: 20px;
            border-radius: 12px;
            box-shadow: 0 5px 15px var(--shadow-color);
            border: 1px solid var(--border-color);
        }

        .test-panel h2 {
            font-size: 18px;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 1px solid var(--border-color);
            color: var(--text-color);
        }

        .test-panel-controls {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            align-items: center;
        }
        
        .test-panel-controls input, .test-panel-controls select {
            padding: 6px 10px;
            border-radius: 4px;
            border: 1px solid var(--border-color);
            background: var(--input-bg);
            color: var(--text-color);
        }

        .test-panel-controls .search-input {
            flex-grow: 1;
        }

        .test-panel-buttons {
            display: flex;
            gap: 5px;
            flex-wrap: wrap;
        }

        .test-panel-buttons button {
             padding: 5px 10px;
            background: var(--input-bg);
            border: 1px solid var(--border-color);
            color: var(--text-color);
            border-radius: 3px;
            cursor: pointer;
            font-size: 13px;
        }
        .test-panel-buttons button:hover {
            background: var(--border-color);
        }

        /* Common Table Styles */
        .table-container {
            background: var(--component-bg);
            border-radius: 8px;
            padding: 20px;
            margin-top: 20px;
            box-shadow: 0 2px 8px var(--shadow-color);
        }
        
        .table-wrapper {
            overflow-x: auto;
            margin: 15px 0;
            border: 1px solid var(--border-color);
            border-radius: 6px;
        }
        
        .table-actions {
            display: flex;
            justify-content: space-between;
            flex-wrap: wrap;
            gap: 10px;
            margin-bottom: 15px;
        }
        
        .range-selector {
            display: flex;
            gap: 10px;
            align-items: center;
        }
        
        .range-selector select {
            padding: 6px 10px;
            border-radius: 4px;
            border: 1px solid var(--border-color);
            background: var(--input-bg);
            color: var(--text-color);
        }
        
        .data-actions {
            display: flex;
            gap: 8px;
            align-items: center;
            flex-wrap: wrap;
        }
        
        .data-actions button {
            padding: 6px 10px;
            background: var(--input-bg);
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 13px;
            color: var(--text-color);
        }
        
        .data-actions input {
            padding: 6px 10px;
            border-radius: 4px;
            border: 1px solid var(--border-color);
            background-color: var(--input-bg);
            color: var(--text-color);
            min-width: 150px;
        }
        
        .sms-table {
            width: 100%;
            border-collapse: collapse;
            background: var(--component-bg);
            font-size: 14px;
        }
        
        .sms-table th {
            background: var(--table-header-bg);
            color: var(--text-color);
            padding: 10px 15px;
            text-align: left;
            font-weight: 600;
        }
        
        .sms-table td {
            padding: 10px 15px;
            border-bottom: 1px solid var(--border-color);
        }

        .sms-table th, .sms-table td {
            white-space: nowrap;
        }
        
        .pagination {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 15px;
            padding-top: 15px;
            border-top: 1px solid var(--border-color);
            flex-wrap: wrap;
            gap: 10px;
        }
        
        .pagination-info {
            font-size: 14px;
            color: #888;
        }
        
        .pagination-controls {
            display: flex;
            flex-wrap: wrap;
            gap: 4px;
        }

        .pagination-controls button {
            padding: 5px 10px;
            background: var(--input-bg);
            border: 1px solid var(--border-color);
            color: var(--text-color);
            border-radius: 3px;
            cursor: pointer;
        }
        .pagination-controls button:hover {
            background: var(--border-color);
        }
        .pagination-controls button.active {
            background: var(--primary);
            color: white;
            border-color: var(--primary);
        }
        .pagination-controls button:disabled {
            cursor: not-allowed;
            opacity: 0.6;
        }

        /* SMS Reports Section Styles */
        #sms-reports-container p, #sms-range-container p {
            margin-bottom: 15px;
            font-size: 16px;
            color: var(--text-color);
        }
        .report-filters {
            background-color: var(--component-bg);
            border: 1px solid var(--border-color);
            padding: 15px;
            border-radius: 8px;
            display: flex;
            flex-direction: column;
            gap: 15px;
            margin-bottom: 20px;
        }
        .filter-row {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            align-items: center;
        }
        .filter-row input[type="text"], .filter-row select {
            padding: 8px;
            border-radius: 4px;
            border: 1px solid var(--border-color);
            background-color: var(--input-bg);
            color: var(--text-color);
            flex-grow: 1;
        }
        .group-by-label {
            font-weight: 500;
            margin-right: 5px;
        }
        .group-by-options {
            display: flex;
            gap: 15px;
            align-items: center;
        }
        .group-by-options label {
            display: flex;
            align-items: center;
            gap: 5px;
            font-weight: 400;
        }
        .report-actions {
            margin-left: auto;
            display: flex;
            gap: 10px;
        }
        .report-actions button {
            padding: 8px 20px;
            border: none;
            border-radius: 5px;
            color: white;
            cursor: pointer;
            font-weight: 500;
            transition: opacity 0.2s;
        }
        .report-actions button:hover {
            opacity: 0.9;
        }
        .btn-export {
            background-color: #f0ad4e;
        }
        .btn-show {
            background-color: var(--secondary);
        }
        .sms-cdr-title {
            font-size: 20px;
            font-weight: 600;
            margin-bottom: 10px;
            padding-bottom: 10px;
            border-bottom: 1px solid var(--border-color);
        }

        
        /* Deposit Section Styles - UPDATED for a more prominent "frame" look */
        .deposit-box {
            background: var(--component-bg);
            padding: 35px;
            border-radius: 20px;
            box-shadow: 0 15px 40px var(--shadow-color);
            max-width: 550px;
            margin: 30px auto;
            text-align: center;
            border: 1px solid var(--border-color);
            position: relative;
            overflow: hidden;
        }
        .deposit-box::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 8px;
            background: linear-gradient(to right, var(--primary), var(--secondary));
            border-top-left-radius: 18px;
            border-top-right-radius: 18px;
        }

        .deposit-logo {
            height: 70px;
            margin-bottom: 30px;
            transition: opacity 0.3s ease-in-out;
            filter: invert(0);
        }
        body.dark-mode .deposit-logo {
            filter: invert(1);
        }

        .deposit-box label {
            display: block;
            margin-bottom: 10px;
            font-weight: 600;
            color: var(--text-color);
            font-size: 17px;
            text-align: left;
        }

        .select-wrapper {
            position: relative;
            width: 100%;
            margin-bottom: 25px;
        }

        .select-wrapper::after {
            content: '\f078';
            font-family: 'Font Awesome 6 Free';
            font-weight: 900;
            position: absolute;
            top: 50%;
            right: 18px;
            transform: translateY(-50%);
            pointer-events: none;
            color: var(--primary);
            font-size: 18px;
        }

        .deposit-box select {
            width: 100%;
            padding: 15px 18px;
            border: 1px solid var(--border-color);
            border-radius: 10px;
            font-size: 16px;
            appearance: none;
            -webkit-appearance: none;
            background: var(--input-bg);
            color: var(--text-color);
            cursor: pointer;
            box-shadow: inset 0 2px 5px rgba(0,0,0,0.05);
        }

        .deposit-box select:focus {
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(106, 17, 203, 0.2), inset 0 2px 5px rgba(0,0,0,0.05);
            outline: none;
        }

        .network-details {
            margin-top: 25px;
            padding: 20px;
            background: var(--input-bg);
            border-radius: 10px;
            border: 1px solid var(--border-color);
            text-align: left;
            box-shadow: inset 0 0 10px rgba(0,0,0,0.03);
        }

        .network-details p {
            margin-bottom: 12px;
            font-weight: 700;
            color: var(--text-color);
            font-size: 15px;
        }

        .address-box {
            display: flex;
            align-items: center;
            justify-content: space-between;
            background: #eef2f5;
            padding: 12px 15px;
            border-radius: 8px;
            font-family: 'Roboto Mono', monospace;
            word-break: break-all;
            font-size: 14px;
            border: 1px solid var(--border-color);
            color: #333;
        }
        body.dark-mode .address-box {
            background: #4a4b4c;
            color: #f1f1f1;
        }

        .address-box .copy-btn {
            background: none;
            border: none;
            color: var(--primary);
            cursor: pointer;
            font-size: 20px;
            margin-left: 15px;
            transition: color 0.2s ease, transform 0.2s ease;
        }
        
        .address-box .copy-btn:hover {
            color: var(--secondary);
            transform: scale(1.1);
        }

        .amount-section {
            margin-top: 30px;
            text-align: left;
        }

        .info-box {
            display: flex;
            align-items: center;
            gap: 10px;
            background-color: rgba(246, 211, 101, 0.2);
            color: #8a6d3b;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 20px;
            border: 1px solid rgba(246, 211, 101, 0.7);
            font-size: 15px;
            font-weight: 500;
        }
        body.dark-mode .info-box {
             color: #f8d879;
        }
        .info-box i {
            font-size: 20px;
            color: #d1a52e;
        }

        .deposit-box input[type="number"],
        .deposit-box input[type="text"] {
            width: 100%;
            padding: 15px 18px;
            margin-bottom: 20px;
            border: 1px solid var(--border-color);
            border-radius: 10px;
            font-size: 16px;
            box-shadow: inset 0 2px 5px rgba(0,0,0,0.05);
            background-color: var(--input-bg);
            color: var(--text-color);
        }
        .deposit-box input[type="number"]:focus,
        .deposit-box input[type="text"]:focus {
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(106, 17, 203, 0.2), inset 0 2px 5px rgba(0,0,0,0.05);
            outline: none;
        }
        
        #deposit-button {
            width: 100%;
            padding: 18px;
            background: linear-gradient(to right, var(--success), #28a745);
            color: white;
            border: none;
            border-radius: 10px;
            font-size: 19px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.68, -0.55, 0.27, 1.55);
            margin-top: 15px;
            box-shadow: 0 8px 25px rgba(40, 167, 69, 0.25);
            text-transform: uppercase;
            letter-spacing: 0.8px;
        }

        #deposit-button:hover {
            transform: translateY(-3px) scale(1.01);
            box-shadow: 0 12px 30px rgba(40, 167, 69, 0.4);
            filter: brightness(1.05);
        }

        #deposit-button:disabled {
            background: #aaa;
            cursor: not-allowed;
            box-shadow: 0 4px 10px var(--shadow-color);
        }

        .deposit-message {
            margin-top: 20px;
            font-weight: 600;
            height: 25px;
            text-align: center;
            transition: color 0.3s;
            font-size: 15px;
        }

        /* Processing Animation */
        #deposit-button.processing {
            animation: glowing 1.5s infinite ease-in-out;
        }

        @keyframes glowing {
            0% { box-shadow: 0 0 8px rgba(40, 167, 69, 0.5), 0 0 15px rgba(40, 167, 69, 0.3); }
            50% { box-shadow: 0 0 25px rgba(40, 167, 69, 0.8), 0 0 40px rgba(40, 167, 69, 0.6); }
            100% { box-shadow: 0 0 8px rgba(40, 167, 69, 0.5), 0 0 15px rgba(40, 167, 69, 0.3); }
        }

        /* History Section */
        .history-container {
            background: var(--component-bg);
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 10px 30px var(--shadow-color);
            max-width: 900px;
            margin: 40px auto;
        }
        .history-container h2 {
            text-align: center;
            margin-bottom: 20px;
            color: var(--text-color);
        }
        .status-completed {
            color: var(--success);
            font-weight: 600;
        }
        .status-pending {
            color: var(--warning);
            font-weight: 600;
        }
        .status-failed {
            color: var(--danger);
            font-weight: 600;
        }
        
        /* Copyright Footer */
        .copyright-footer {
            margin-top: auto; /* Push footer to the bottom */
            padding: 15px;
            text-align: center;
            font-size: 13px;
            color: var(--text-color);
            background: var(--component-bg);
            border-top: 1px solid var(--border-color);
        }

        /* Responsive Design */
        @media (max-width: 1024px) {
            .sms-test-wrapper {
                grid-template-columns: 1fr;
            }
            .main-content.shifted {
                margin-left: 0;
            }
        }
        @media (max-width: 768px) {
            .main-content.shifted {
                margin-left: 0;
            }
            
            .nav-button {
                padding: 20px;
            }
            
            .sms-item {
                flex-direction: column;
                align-items: flex-start;
            }
            
            .table-actions {
                flex-direction: column;
                align-items: flex-start;
            }
            
            .range-selector, .data-actions {
                width: 100%;
            }
            
            .data-actions {
                margin-top: 10px;
            }
            /* Adjust deposit box for smaller screens */
            .deposit-box {
                padding: 25px;
                border-radius: 15px;
            }
            .deposit-box::before {
                height: 5px;
            }
        }
    </style>
</head>
<body>
    <!-- Login Page -->
    <div id="login-container">
        <div class="login-box">
            <div class="login-box-header">
                <p class="welcome-text">Welcome to</p>
                <h2>Poler SMS Panel</h2>
                <div class="lock-icon-circle"><i class="fas fa-lock"></i></div>
            </div>
            <div class="login-box-body">
                <form id="login-form">
                    <input type="text" id="username" placeholder="Email" required>
                    <input type="password" id="password" placeholder="Password" required>
                    <div class="keep-logged-in">
                        <input type="checkbox" id="keep-me-logged-in">
                        <label for="keep-me-logged-in">Keep me logged in</label>
                    </div>
                    <!-- === CAPTCHA ELEMENT ADDED BACK HERE === -->
                    <div class="captcha" id="captchaQuestion"></div>
                    <input type="text" id="captcha-answer" placeholder="Answer" required>
                    <button type="submit">LOGIN</button>
                </form>
                <!-- Error Support Message -->
                <div id="support-message-on-error" class="error-support-message" style="display: none;">
                    <p><i class="fas fa-exclamation-circle"></i> Please contact our support for assistance:</p>
                    <a href="https://www.facebook.com/share/1JQVi7e7En/" target="_blank">
                        <i class="fab fa-facebook"></i> Facebook Support
                    </a>
                </div>
                <!-- General Support Link -->
                <div class="support-login-link">
                    <p>Need assistance? <a href="mailto:charlesjames997@outlook.com"><i class="fas fa-headset"></i> Contact Support</a></p>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Global elements outside the content wrapper -->
    <button class="menu-toggle" id="menuToggle"><i class="fas fa-bars"></i></button>
    <div class="sidebar" id="sidebar">
        <!-- User Profile Frame -->
        <div class="user-profile-frame">
            <div class="profile-top-row">
                <h4 id="sidebar-username"></h4>
                <span class="panel-tag">agent panel</span>
            </div>
            <p id="sidebar-userid"></p>
        </div>

        <h3>Navigation</h3>
        <ul>
            <li class="active" data-section="dashboard"><i class="fas fa-home"></i> Dashboard</li>
            <li data-section="sms-range"><i class="fas fa-list"></i> SMS Range</li>
            <li data-section="sms-number"><i class="fas fa-mobile-alt"></i> SMS Number</li>
            <li data-section="sms-reports"><i class="fas fa-chart-bar"></i> SMS Reports</li>
            <li data-section="deposit"><i class="fas fa-wallet"></i> Deposit</li>
            <li data-section="sms-test"><i class="fas fa-vial"></i> SMS Test Panel</li>
            <li class="sign-out" id="signOut"><i class="fas fa-sign-out-alt"></i> Sign Out</li>
             <!-- Dark Mode Toggle -->
            <div class="theme-switch-wrapper">
                <label class="theme-switch" for="dark-mode-toggle">
                    <input type="checkbox" id="dark-mode-toggle" />
                    <div class="slider round"></div>
                </label>
                <span>Dark Mode</span>
            </div>
            <!-- Social Support Links (Framed) -->
            <li class="social-support-link">
                <a href="https://www.facebook.com/share/1JQVi7e7En/" target="_blank" title="Contact us on Facebook">
                    <i class="fab fa-facebook"></i> Facebook
                </a>
            </li>
            <li class="social-support-link">
                <a href="mailto:charlesjames997@outlook.com" title="Chat on Skype">
                    <i class="fab fa-skype"></i> Skype
                </a>
            </li>
        </ul>
    </div>

    <!-- Main Content Wrapper -->
    <div class="main-content" id="main-content-wrapper" style="display:none;">
        <div id="dashboard-container" class="container"></div>
        <div id="sms-number-container" class="container"></div>
        <div id="sms-range-container" class="container"></div>
        <div id="sms-reports-container" class="container"></div>
        <div id="deposit-container" class="container"></div>
        <div id="sms-test-container" class="container"></div>
    </div>

    <!-- Copyright Footer -->
    <footer class="copyright-footer">
        <p>&copy; 2024 Poler SMS. All rights reserved.</p>
    </footer>

    <script>
        // --- IMMEDIATE THEME APPLY SCRIPT ---
        (function() {
            const theme = localStorage.getItem('theme');
            if (theme === 'dark') {
                document.body.classList.add('dark-mode');
            }
        })();
    </script>
    <script type="module">
        // --- Firebase     ---
        let auth, app;

        // --- TEMPLATES for dynamic content ---
        const templates = {
            dashboard: `
                <div class="header"><h1>Poler SMS</h1></div>
                <h2 class="dashboard-title">SMS Dashboard</h2>
                <p style="margin-bottom: 25px; color: #666; font-weight: 500;">View Summarized Stats & Reports</p>
                <div class="nav-buttons-container">
                    <div class="nav-button" data-section="dashboard"><i class="fas fa-tachometer-alt"></i><h3>Dashboard</h3></div>
                    <div class="nav-button" data-section="sms-range"><i class="fas fa-list-ol"></i><h3>SMS Range</h3></div>
                    <div class="nav-button" data-section="sms-number"><i class="fas fa-mobile-alt"></i><h3>SMS Number</h3></div>
                    <div class="nav-button" data-section="sms-reports"><i class="fas fa-chart-bar"></i><h3>SMS Reports</h3></div>
                    <div class="nav-button" data-section="deposit"><i class="fas fa-money-bill-wave"></i><h3>Deposit</h3></div>
                </div>
                
                <!-- NEW STATS & CHART SECTION -->
                <div class="stats-and-chart-container">
                    <div class="stats-grid">
                        <div class="stat-box">
                            <div class="stat-box-left">
                                <div class="stat-icon"><i class="fas fa-comment-dots"></i></div>
                                <div class="stat-info">
                                    <h5>Today SMS</h5>
                                    <p id="today-sms-count">0</p>
                                </div>
                            </div>
                            <div class="stat-trend"><i class="fas fa-arrow-up"></i></div>
                        </div>
                        <div class="stat-box">
                            <div class="stat-box-left">
                                <div class="stat-icon"><i class="fas fa-calendar-week"></i></div>
                                <div class="stat-info">
                                    <h5>Last 7 Day SMS</h5>
                                    <p id="seven-day-sms-count">0</p>
                                </div>
                            </div>
                            <div class="stat-trend"><i class="fas fa-arrow-up"></i></div>
                        </div>
                        <div class="stat-box">
                            <div class="stat-box-left">
                                <div class="stat-icon"><i class="fas fa-calendar-alt"></i></div>
                                <div class="stat-info">
                                    <h5>Last 30 Day SMS</h5>
                                    <p id="thirty-day-sms-count">0</p>
                                </div>
                            </div>
                            <div class="stat-trend"><i class="fas fa-arrow-up"></i></div>
                        </div>
                    </div>
                    <div class="chart-container">
                        <canvas id="smsChart"></canvas>
                    </div>
                </div>

                <div class="live-sms-container">
                    <div class="live-sms-header">
                        <h3 class="live-sms-title">LIVE SMS <span class="live-indicator"></span></h3>
                        <button class="refresh-btn" id="refreshSms"><i class="fas fa-sync-alt"></i> Refresh</button>
                    </div>
                    <div class="sms-platforms" style="display: none;"></div>
                    <div class="live-sms-list" id="smsList"></div>
                </div>`,
            smsNumber: `
                <div class="header"><h1>My SMS Numbers</h1><button class="back-to-dashboard"><i class="fas fa-arrow-left"></i> Back</button></div>
                <div class="table-container"><div class="table-actions"><div class="range-selector"><select><option>100</option><option>50</option><option>25</option><option>10</option></select><button>Print</button></div><div class="data-actions"><span>Show Records: 28</span><button>Copy</button><button>CSV</button><button>Excel</button><button>PDF</button><button>Print</button><input type="text" placeholder="Search..."></div></div><div class="table-wrapper"><table class="sms-table"><thead><tr><th>BANDE</th><th>PREFIX</th><th>NUMBER</th><th>MY PATTERN</th><th>MY KNOWT</th><th>LIMITS</th></tr></thead><tbody><tr><td colspan="6" style="text-align: center;">No data available in table</td></tr></tbody></table></div><div class="pagination"><div class="pagination-info">Showing 0 to 0 of 0 entries</div><div class="pagination-controls"><button>First</button><button>Previous</button><button>Next</button><button>Last</button></div></div></div>`,
            smsRange: `
                <div class="header"><h1>SMS Range</h1><button class="back-to-dashboard"><i class="fas fa-arrow-left"></i> Back</button></div>
                <p>Our All Ranges will show here.. you can search your desired range and request numbers.</p>
                <div class="table-container"><h3 class="sms-cdr-title">ALL SMS RANGES/TERMINATIONS</h3><div class="table-actions"><div class="data-actions"><label for="sms-range-search-input" class="sr-only">Search</label><input type="text" id="sms-range-search-input" placeholder="Search..." style="min-width: 250px;"></div><div class="data-actions"><button>Copy</button><button>CSV</button><button>Excel</button><button>PDF</button><button>Print</button></div><div class="range-selector"><span>Show Records:</span><select id="sms-range-records-per-page"><option>25</option><option>50</option><option>100</option></select></div></div><div class="table-wrapper"><table class="sms-table" id="sms-range-table"><thead><tr><th>Range</th><th>Prefix</th><th>Test Number</th><th>Currency</th></tr></thead><tbody id="sms-range-tbody"></tbody></table></div><div class="pagination"><div class="pagination-info" id="sms-range-pagination-info"></div><div class="pagination-controls" id="sms-range-pagination-controls"></div></div></div>`,
            smsReports: `
                <div class="header"><h1>SMS Reports</h1><button class="back-to-dashboard"><i class="fas fa-arrow-left"></i> Back</button></div>
                <p>Here You can view all the sms stats.</p>
                <div class="report-filters"><div class="filter-row"><input type="text" value="2025-08-14 00:00"><input type="text" value="2025-08-14 23:59"><select><option>Filter Range</option></select><input type="text" placeholder="Search Number"><input type="text" placeholder="Search CLI"></div><div class="filter-row"><div class="group-by-options"><span class="group-by-label">Group By:</span><label><input type="checkbox"> Date</label><label><input type="checkbox"> Month</label><label><input type="checkbox"> Range</label><label><input type="checkbox"> Number</label><label><input type="checkbox"> CLI</label></div><div class="report-actions"><button class="btn-export">Export Report</button><button class="btn-show">Show Report</button></div></div></div>
                <div class="table-container"><h3 class="sms-cdr-title">SMS CDR REPORTS & STATS</h3><div class="table-actions"><div class="data-actions"><input type="text" placeholder="Search..." style="min-width: 200px;"></div><div class="data-actions"><button>Copy</button><button>CSV</button><button>Excel</button><button>PDF</button><button>Print</button></div><div class="range-selector"><span>Show Records:</span><select><option>25</option><option>50</option><option>100</option></select></div></div><div class="table-wrapper"><table class="sms-table"><thead><tr><th>Date</th><th>Range</th><th>Number</th><th>CLI</th><th>SMS</th></tr></thead><tbody><tr><td><b>Total SMS</b><br>0</td><td></td><td></td><td></td><td></td></tr></tbody></table></div><div class="pagination"><div class="pagination-info">Showing 0 to 0 of 0 entries</div><div class="pagination-controls"><button disabled>First</button><button disabled>Previous</button><button disabled>Next</button><button disabled>Last</button></div></div></div>`,
            deposit: `
                <div class="header"><h1>Deposit</h1><button class="back-to-dashboard"><i class="fas fa-arrow-left"></i> Back</button></div>
                <div class="deposit-box"><img src="https://i.ibb.co/yWXFv9F/binance-pay-logo.png" alt="Binance Logo" id="network-logo" class="deposit-logo"><label for="network-select">Choose Network</label><div class="select-wrapper"><select id="network-select"><option value="trc20">Tron (TRC20)</option><option value="bep20">BNB (BEP20)</option></select></div><div id="trc20-details" class="network-details"><p><strong>TRC20 Address:</strong></p><div class="address-box"><span id="trc20-address">TNYc7aKa4ouHBQCRRgQihoRKP4vTcEwBYP</span><button class="copy-btn" data-copy-target="trc20-address" title="Copy Address"><i class="fas fa-copy"></i></button></div></div><div id="bep20-details" class="network-details" style="display: none;"><p><strong>BNB (BEP20) Address:</strong></p><div class="address-box"><span id="bep20-address">0xf764bb815ed75339df04107a148c4ca4bf3e5a72</span><button class="copy-btn" data-copy-target="bep20-address" title="Copy Address"><i class="fas fa-copy"></i></button></div></div><div class="amount-section"><div class="info-box"><i class="fas fa-info-circle"></i><span>Minimum amount 20$</span></div><label for="deposit-amount">Amount</label><input type="number" id="deposit-amount" placeholder="Enter amount (e.g., 20)" min="20"><label for="transaction-id">Transaction ID</label><input type="text" id="transaction-id" placeholder="Enter your transaction ID/Hash"><button id="deposit-button">Deposit</button></div><p id="deposit-message" class="deposit-message"></p></div>
                <div class="history-container"><h2>Deposit History</h2><div class="table-wrapper"><table class="sms-table"><thead><tr><th>Date & Time</th><th>Amount (USD)</th><th>Network</th><th>Transaction ID</th><th>Status</th></tr></thead><tbody id="deposit-history-body"></tbody></table></div></div>`,
            smsTest: `
                <div class="header"><h1>SMS Test Panel</h1><button class="back-to-dashboard"><i class="fas fa-arrow-left"></i> Back</button></div>
                <div class="sms-test-wrapper"><div class="test-panel"><h2>SMS TEST NUMBERS</h2><div class="test-panel-controls"><input type="text" placeholder="Search..." class="search-input"><select id="sms-test-numbers-records-per-page"><option>25</option><option>50</option><option>100</option></select></div><div class="test-panel-buttons" style="margin-bottom: 15px;"><button id="btn-copy-1">Copy</button><button id="btn-csv-1">CSV</button><button id="btn-excel-1">Excel</button><button id="btn-pdf-1">PDF</button><button id="btn-print-1">Print</button></div><div class="table-wrapper" style="max-height: 400px; overflow-y: auto;"><table class="sms-table" id="sms-test-numbers-table"><thead><tr><th>Range</th><th>Prefix</th><th>Test Number</th><th>Payout</th><th>Limits</th></tr></thead><tbody id="sms-test-numbers-tbody"></tbody></table></div><div class="pagination"><div class="pagination-info" id="sms-test-numbers-pagination-info"></div><div class="pagination-controls" id="sms-test-numbers-pagination-controls"></div></div></div><div class="test-panel"><h2>RECENT SMS TEST</h2><div class="test-panel-controls"><input type="text" placeholder="Search..." class="search-input"><select id="recent-sms-test-records-per-page"><option>25</option><option>50</option><option>100</option></select></div><div class="test-panel-buttons" style="margin-bottom: 15px;"><button id="btn-copy-2">Copy</button><button id="btn-csv-2">CSV</button><button id="btn-excel-2">Excel</button><button id="btn-pdf-2">PDF</button><button id="btn-print-2">Print</button></div><div class="table-wrapper" style="max-height: 400px; overflow-y: auto;"><table class="sms-table" id="recent-sms-test-table"><thead><tr><th>Date</th><th>Range</th><th>Number</th><th>CLI</th><th>SMS</th></tr></thead><tbody id="recent-sms-test-tbody"></tbody></table></div><div class="pagination"><div class="pagination-info" id="recent-sms-test-pagination-info"></div><div class="pagination-controls" id="recent-sms-test-pagination-controls"></div></div></div>`
        };
        
        // --- DYNAMIC DATA AND HELPERS ---
        const generateRandomNumber = (length) => {
            if (length <= 0) return '';
            const min = Math.pow(10, length - 1);
            const max = Math.pow(10, length) - 1;
            return Math.floor(min + Math.random() * (max - min + 1));
        };
        const maskService = (service) => service.substring(0, 3) + 'XXXXX';

        // --- Dashboard SMS Data (UPDATED with more apps and dynamic OTPs) ---
        const smsData = [
            { platform: "Indian WhatsApp", icon: 'fab fa-whatsapp', color: '#25D366', number: "+91 98765XXXXX", content: "Your WhatsApp code is _CODE_.", otpLength: 6 },
            { platform: "Saudi WhatsApp", icon: 'fab fa-whatsapp', color: '#25D366', number: "+966 54321XXXXX", content: "Verification code: _CODE_.", otpLength: 6 },
            { platform: "Telegram", icon: 'fab fa-telegram-plane', color: '#0088cc', number: "+58 12345XXXXX", content: "Telegram login code: _CODE_.", otpLength: 5 }, // 5 digits for Telegram
            { platform: "Google", icon: 'fab fa-google', color: '#DB4437', number: "+1 41555XXXXX", content: "G-_CODE_ is your Google verification code.", otpLength: 6 },
            { platform: "Facebook", icon: 'fab fa-facebook', color: '#4267B2', number: "+44 78901XXXXX", content: "_CODE_ is your Facebook code.", otpLength: 6 },
            { platform: "TikTok", icon: 'fab fa-tiktok', color: '#000000', number: "+62 81234XXXXX", content: "Your TikTok verification code is _CODE_.", otpLength: 6 },
            { platform: "Microsoft", icon: 'fab fa-microsoft', color: '#F25022', number: "+1 21255XXXXX", content: "Microsoft access code: _CODE_.", otpLength: 6 }, 
            { platform: "IMO", icon: 'fas fa-comment-alt', color: '#2575fc', number: "+880 17123XXXXX", content: "Your IMO verification code is _CODE_.", otpLength: 6 }
        ];
        
        // --- Deposit History Data ---
        const sampleDepositHistory = [
            { date: "2025-08-14 10:30 AM", amount: "50.00", network: "TRC20", tx: "a1b2...f6e5", status: "Completed", statusClass: "status-completed" },
            { date: "2025-08-13 03:45 PM", amount: "100.00", network: "BEP20", tx: "x1y2...c6b5", status: "Completed", statusClass: "status-completed" },
            { date: "2025-08-13 11:00 AM", amount: "25.00", network: "TRC20", tx: "m1n2...q5r6", status: "Failed", statusClass: "status-failed" },
            { date: "2025-08-12 09:15 AM", amount: "250.00", network: "BEP20", tx: "p4q5...k9j8", status: "Completed", statusClass: "status-completed" },
            { date: "2025-08-11 08:50 PM", amount: "35.50", network: "TRC20", tx: "h2g3...d4c3", status: "Pending", statusClass: "status-pending" },
            { date: "2025-08-11 01:20 PM", amount: "75.00", network: "BEP20", tx: "b5c6...z3y2", status: "Completed", statusClass: "status-completed" },
            { date: "2025-08-10 06:00 AM", amount: "40.00", network: "TRC20", tx: "v6w7...u8t9", status: "Completed", statusClass: "status-completed" },
        ];
        let depositHistoryInterval = null;

        // --- CAPTCHA LOGIC ---
        let currentCaptcha;
        function generateCaptcha() {
            const num1 = Math.floor(Math.random() * 10) + 1;
            const num2 = Math.floor(Math.random() * 10) + 1;
            currentCaptcha = {
                question: `What is ${num1} + ${num2} = ?`,
                answer: (num1 + num2).toString()
            };
            document.getElementById('captchaQuestion').textContent = currentCaptcha.question;
        }

        // --- DASHBOARD LIVE SMS LOGIC (UPDATED for OTP length and timing) ---
        function generateRandomSMS() {
            const smsList = document.getElementById('smsList');
            if (!smsList) return;
            // Clear existing SMS to simulate new ones arriving
            smsList.innerHTML = ''; 

            const shuffled = [...smsData].sort(() => 0.5 - Math.random()).slice(0, 5); // Display 5 random SMS
            shuffled.forEach(sms => {
                let otp = generateRandomNumber(sms.otpLength); // Use dynamic OTP length
                let finalContent = sms.content.replace("_CODE_", otp);
                const smsItem = document.createElement('div');
                smsItem.className = 'sms-item';
                smsItem.innerHTML = `
                    <div class="sms-icon" style="color: ${sms.color};"><i class="${sms.icon}"></i></div>
                    <div class="sms-details">
                        <div class="sms-number">${sms.number}</div>
                        <div class="sms-content">${finalContent}</div>
                    </div>
                    <div class="sms-time">${Math.floor(Math.random() * 59) + 1} secs ago</div>`;
                smsList.appendChild(smsItem);
            });
        }
        
        // --- Function to initialize dashboard chart ---
        function initializeDashboardChart() {
            const ctx = document.getElementById('smsChart');
            if (!ctx) return;

            // Check if a chart instance already exists and destroy it
            if (window.mySmsChart instanceof Chart) {
                window.mySmsChart.destroy();
            }

            const chartData = Array.from({ length: 7 }, () => Math.floor(Math.random() * (150 - 60 + 1)) + 60);
            const labels = [];
            for (let i = 6; i >= 0; i--) {
                const d = new Date();
                d.setDate(d.getDate() - i);
                labels.push(d.toLocaleDateString('en-US', { month: 'short', day: 'numeric' }));
            }
            
            const isDarkMode = document.body.classList.contains('dark-mode');
            const gridColor = isDarkMode ? 'rgba(255, 255, 255, 0.1)' : 'rgba(0, 0, 0, 0.1)';
            const labelColor = isDarkMode ? '#e4e6eb' : '#2d3436';

            window.mySmsChart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: labels,
                    datasets: [{
                        label: 'SMS Received',
                        data: chartData,
                        fill: false,
                        borderColor: 'rgba(37, 117, 252, 1)',
                        backgroundColor: 'rgba(37, 117, 252, 1)',
                        tension: 0.1,
                        borderWidth: 3,
                        pointRadius: 5,
                        pointHoverRadius: 7
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { display: false },
                        title: {
                             display: true,
                             text: 'SMS LAST 7 DAYS',
                             font: { size: 16, weight: '500' },
                             color: labelColor
                        }
                    },
                    scales: { 
                        y: { 
                            beginAtZero: false, 
                            min: 60, 
                            max: 150,
                            grid: { color: gridColor },
                            ticks: { color: labelColor }
                        },
                        x: {
                            grid: { color: gridColor },
                            ticks: { color: labelColor }
                        }
                    }
                }
            });
        }
        
        // --- LOGIN AND NAVIGATION ---
        const sidebar = document.getElementById('sidebar');
        const mainContentWrapper = document.getElementById('main-content-wrapper');
        const menuToggle = document.getElementById('menuToggle');
        let smsRefreshInterval;
        let failedLoginAttempts = 0;
        const MAX_FAILED_ATTEMPTS = 2;

        function showSection(section) {
            if (!section || section === 'sign-out') return;
            
            clearInterval(depositHistoryInterval);
            clearInterval(smsRefreshInterval);

            document.querySelectorAll('.sidebar li').forEach(li => {
                li.classList.remove('active');
                if (li.getAttribute('data-section') === section) li.classList.add('active');
            });

            document.querySelectorAll('.container').forEach(c => c.style.display = 'none');
            const containerToShow = document.getElementById(section + '-container');
            
            if (containerToShow) {
                const templateKey = section.replace(/-(\w)/g, (_, c) => c.toUpperCase());
                containerToShow.innerHTML = templates[templateKey] || '';
                containerToShow.style.display = 'block';
                
                if (section === 'dashboard') {
                    generateRandomSMS();
                    document.getElementById('refreshSms').addEventListener('click', generateRandomSMS);
                    smsRefreshInterval = setInterval(generateRandomSMS, 25000);
                    
                    document.getElementById('today-sms-count').textContent = Math.floor(Math.random() * (150 - 80) + 80);
                    document.getElementById('seven-day-sms-count').textContent = Math.floor(Math.random() * (999 - 700) + 700);
                    document.getElementById('thirty-day-sms-count').textContent = Math.floor(Math.random() * (9000 - 7000) + 7000);
                    initializeDashboardChart();

                } else if (section === 'deposit') {
                    initializeDepositSection();
                } else if (section === 'sms-test') {
                    loadOrGenerateSmsTestNumbersData();
                    setupPagination(smsTestNumbersConfig);
                    setupPagination(recentSmsTestConfig);
                } else if (section === 'sms-range') {
                    smsRangeConfig.data = allSmsRangeData;
                    setupPagination(smsRangeConfig);
                     document.getElementById('sms-range-search-input').addEventListener('keyup', (e) => {
                        const searchTerm = e.target.value.toLowerCase();
                        smsRangeConfig.data = allSmsRangeData.filter(item =>
                            item.range.toLowerCase().includes(searchTerm) ||
                            item.prefix.includes(searchTerm) ||
                            item.testNumber.includes(searchTerm)
                        );
                        setupPagination(smsRangeConfig);
                    });
                }
                attachCommonListeners();
            }
        }
        
        function attachCommonListeners() {
            document.querySelectorAll('.back-to-dashboard').forEach(button => {
                button.addEventListener('click', () => showSection('dashboard'));
            });
            document.querySelectorAll('.nav-button').forEach(button => {
                 button.addEventListener('click', () => showSection(button.dataset.section));
            });
        }
        
        menuToggle.addEventListener('click', () => {
            sidebar.classList.toggle('active');
            mainContentWrapper.classList.toggle('shifted');
        });
        
        document.querySelectorAll('.sidebar li').forEach(item => {
            if (item.hasAttribute('data-section')) {
                item.addEventListener('click', function() {
                    const section = this.getAttribute('data-section');
                    showSection(section);
                     if (window.innerWidth <= 768) {
                        sidebar.classList.remove('active');
                        mainContentWrapper.classList.remove('shifted');
                    }
                });
            }
        });

        document.getElementById('signOut').addEventListener('click', () => {
            document.getElementById('login-container').style.display = 'flex';
            mainContentWrapper.style.display = 'none';
            menuToggle.style.display = 'none';
            sidebar.classList.remove('active');
            mainContentWrapper.classList.remove('shifted');
            generateCaptcha();
            document.getElementById('captcha-answer').value = '';
            clearInterval(smsRefreshInterval);
            failedLoginAttempts = 0;
            document.getElementById('support-message-on-error').style.display = 'none';
        });

        // --- DARK MODE LOGIC ---
        const darkModeToggle = document.getElementById('dark-mode-toggle');

        // Sync toggle state with the current theme on load
        if (localStorage.getItem('theme') === 'dark') {
            darkModeToggle.checked = true;
        }

        darkModeToggle.addEventListener('change', () => {
            if (darkModeToggle.checked) {
                document.body.classList.add('dark-mode');
                localStorage.setItem('theme', 'dark');
            } else {
                document.body.classList.remove('dark-mode');
                localStorage.setItem('theme', 'light');
            }
            // Re-initialize chart with new colors if it's visible
            if (document.getElementById('smsChart')) {
                initializeDashboardChart();
            }
        });
        
        // --- DEPOSIT HISTORY & SECTION LOGIC ---
        function updateDepositHistory() {
            const historyBody = document.getElementById('deposit-history-body');
            if (!historyBody) return;
            
            sampleDepositHistory.sort((a, b) => new Date(b.date) - new Date(a.date));

            historyBody.innerHTML = '';
            sampleDepositHistory.forEach(item => {
                const row = document.createElement('tr');
                row.style.animation = 'fadeIn 0.5s ease';
                row.innerHTML = `
                    <td>${item.date}</td>
                    <td>${item.amount}</td>
                    <td>${item.network}</td>
                    <td>${item.tx}</td>
                    <td><span class="${item.statusClass}">${item.status}</span></td>
                `;
                historyBody.appendChild(row);
            });
        }

        function initializeDepositSection() {
             const networkSelect = document.getElementById('network-select');
             const trc20Details = document.getElementById('trc20-details');
             const bep20Details = document.getElementById('bep20-details');
             const depositButton = document.getElementById('deposit-button');
             const amountInput = document.getElementById('deposit-amount');
             const txInput = document.getElementById('transaction-id');
             const messageEl = document.getElementById('deposit-message');

             if(!networkSelect) return;
             
             updateDepositHistory();
             
             networkSelect.addEventListener('change', () => {
                const selectedNetwork = networkSelect.value;
                if (selectedNetwork === 'trc20') {
                    trc20Details.style.display = 'block';
                    bep20Details.style.display = 'none';
                } else {
                    trc20Details.style.display = 'none';
                    bep20Details.style.display = 'block';
                }
             });

             document.querySelectorAll('.copy-btn').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    const targetId = btn.dataset.copyTarget;
                    const address = document.getElementById(targetId).innerText;
                    navigator.clipboard.writeText(address).then(() => {
                        const originalIcon = btn.innerHTML;
                        btn.innerHTML = '<i class="fas fa-check"></i>';
                        setTimeout(() => { btn.innerHTML = originalIcon; }, 2000);
                    });
                });
             });

             depositButton.addEventListener('click', () => {
                const amount = parseFloat(amountInput.value);
                const txId = txInput.value.trim();
                
                messageEl.textContent = '';
                messageEl.style.color = 'var(--danger)';

                if (isNaN(amount) || amount < 20) {
                    messageEl.textContent = 'Please enter a valid amount (minimum 20).';
                    return;
                }
                if (!txId) {
                    messageEl.textContent = 'Please enter the Transaction ID/Hash.';
                    return;
                }

                messageEl.style.color = 'var(--dark)';
                messageEl.textContent = 'Processing your request...';
                depositButton.disabled = true;
                depositButton.classList.add('processing');
                depositButton.textContent = 'PROCESSING...';
                
                setTimeout(() => {
                    depositButton.disabled = false;
                    depositButton.classList.remove('processing');
                    depositButton.textContent = 'DEPOSIT';
                    
                    messageEl.style.color = 'var(--success)';
                    messageEl.textContent = 'Deposit submitted for review!';

                    const newDeposit = {
                        date: new Date().toLocaleString(),
                        amount: amount.toFixed(2),
                        network: networkSelect.value.toUpperCase(),
                        tx: txId.substring(0,4) + '...' + txId.substring(txId.length - 4),
                        status: "Pending",
                        statusClass: "status-pending"
                    };
                    sampleDepositHistory.unshift(newDeposit);
                    updateDepositHistory();

                    amountInput.value = '';
                    txInput.value = '';
                    setTimeout(() => { messageEl.textContent = ''; }, 4000);

                }, 2500);
             });
        }

        // --- PAGINATION LOGIC (REUSABLE) ---
        function setupPagination(config) {
            let currentPage = 1;
            const renderTable = () => {
                const recordsPerPageSelect = document.getElementById(config.recordsPerPageId);
                if (!recordsPerPageSelect) {
                    console.error(`Records per page select element with ID ${config.recordsPerPageId} not found.`);
                    return;
                }
                const recordsPerPage = parseInt(recordsPerPageSelect.value);
                
                const tbody = document.getElementById(config.tbodyId);
                if (!tbody) {
                    console.error(`Table body element with ID ${config.tbodyId} not found.`);
                    return;
                }
                tbody.innerHTML = '';
                const start = (currentPage - 1) * recordsPerPage;
                const end = start + recordsPerPage;
                const paginatedItems = config.data.slice(start, end);
                paginatedItems.forEach(item => {
                    const row = document.createElement('tr');
                    row.innerHTML = config.rowRenderer(item);
                    tbody.appendChild(row);
                });
                renderPaginationControls(recordsPerPage);
            };
            const renderPaginationControls = (recordsPerPage) => {
                const totalItems = config.data.length;
                const totalPages = Math.ceil(totalItems / recordsPerPage);
                const paginationControls = document.getElementById(config.paginationControlsId);
                const paginationInfo = document.getElementById(config.paginationInfoId);

                if (!paginationControls || !paginationInfo) {
                    console.error("Pagination controls or info element not found for config:", config);
                    return;
                }

                paginationControls.innerHTML = '';
                if(totalPages === 0) {
                     paginationInfo.innerText = 'Showing 0 to 0 of 0 entries';
                     return;
                }
                const createButton = (text, page) => {
                    const button = document.createElement('button');
                    button.innerText = text;
                    button.addEventListener('click', () => {
                        currentPage = page;
                        renderTable();
                    });
                    return button;
                };
                paginationControls.appendChild(createButton('Previous', currentPage - 1)).disabled = currentPage === 1;
                
                let startPage = Math.max(1, currentPage - 2);
                let endPage = Math.min(totalPages, currentPage + 2);

                if (startPage > 1) {
                     paginationControls.appendChild(createButton('1', 1));
                     if(startPage > 2) paginationControls.insertAdjacentHTML('beforeend', `<button disabled>...</button>`);
                }

                for (let i = startPage; i <= endPage; i++) {
                    const btn = createButton(i, i);
                    if (i === currentPage) btn.classList.add('active');
                    paginationControls.appendChild(btn);
                }

                if (endPage < totalPages) {
                     if(endPage < totalPages - 1) paginationControls.insertAdjacentHTML('beforeend', `<button disabled>...</button>`);
                     paginationControls.appendChild(createButton(totalPages, totalPages));
                }
                
                paginationControls.appendChild(createButton('Next', currentPage + 1)).disabled = currentPage === totalPages;
                const startEntry = (currentPage - 1) * recordsPerPage + 1;
                const endEntry = Math.min(startEntry + recordsPerPage - 1, totalItems);
                paginationInfo.innerText = `Showing ${startEntry} to ${endEntry} of ${totalItems} entries`;
            };

            const recordsPerPageSelect = document.getElementById(config.recordsPerPageId);
            if (recordsPerPageSelect) {
                recordsPerPageSelect.addEventListener('change', () => {
                    currentPage = 1;
                    renderTable();
                });
            }
            renderTable();
        }

        // --- SMS RANGE DATA AND LOGIC ---
        const asianCountries = [
            { name: "Afghanistan", prefix: "+93" }, { name: "Bangladesh", prefix: "+880" },
            { name: "Indonesia", prefix: "+62" }, { name: "Malaysia", prefix: "+60" },
            { name: "Pakistan", prefix: "+92" }, { name: "Philippines", prefix: "+63" },
            { name: "Thailand", prefix: "+66" }, { name: "Vietnam", prefix: "+84" }
        ];

        const userRequestedRanges = [
            { range: "IndiaFT", prefix: "+91" }, { range: "IndiaHT1", prefix: "+91" },
            { range: "IndiaG1", prefix: "+91" }, { range: "VenezuelaF2", prefix: "+58" },
            { range: "VenezuelaHI6", prefix: "+58" }, { range: "VenezuelaAT8", prefix: "+58" },
            { range: "SaudiArabS8", prefix: "+966" }, { range: "SaudiArab78", prefix: "+966" }
        ].map(r => ({ ...r, testNumber: `${r.prefix.replace('+','')}${generateRandomNumber(8)}`, currency: 'USD' }));

        const generateMoreRanges = (count) => {
            const data = [];
            const suffixes = ['bmet', 'bne', 'blf', 'bld', 'bek', 'bck', 'bbx', 'BAL'];
            for (let i = 0; i < count; i++) {
                const country = asianCountries[i % asianCountries.length];
                data.push({
                    range: `${country.name} ${suffixes[i % suffixes.length]}`,
                    prefix: country.prefix,
                    testNumber: `${country.prefix.replace('+','')}${generateRandomNumber(9)}`,
                    currency: i % 2 === 0 ? 'USD' : 'EUR'
                });
            }
            return data;
        };
        const allSmsRangeData = [...userRequestedRanges, ...generateMoreRanges(500)];
        
        const smsRangeConfig = {
            data: allSmsRangeData,
            tbodyId: 'sms-range-tbody',
            paginationControlsId: 'sms-range-pagination-controls',
            paginationInfoId: 'sms-range-pagination-info',
            recordsPerPageId: 'sms-range-records-per-page',
            rowRenderer: item => `
                <td>${item.range}</td>
                <td>${item.prefix}</td>
                <td>${item.testNumber}</td>
                <td>${item.currency}</td>`
        };

        // --- SMS TEST PANEL DATA AND CONFIGS (UPDATED for 24-hour refresh) ---
        const smsTestPanelCountries = [
            { name: 'India', prefix: '+91', range: 'India' }, { name: 'Saudi', prefix: '+966', range: 'Saudi' },
            { name: 'Venezuela', prefix: '+58', range: 'Venezuela' }, { name: 'Egypt', prefix: '+20', range: 'Egypt' },
            { name: 'USA', prefix: '+1', range: 'USA' }, { name: 'Brazil', prefix: '+55', range: 'Brazil' },
            { name: 'China', prefix: '+86', range: 'China' }, { name: 'Japan', prefix: '+81', range: 'Japan' },
            { name: 'Germany', prefix: '+49', range: 'Germany' }, { name: 'UK', prefix: '+44', range: 'UK' },
        ];
        const testNumberSuffixes = ['Mobile', 'Cell', 'Test', 'Line', 'Phone'];

        function generateSmsTestNumbersData() {
            const data = [];
            const numberOfEntries = 2500;
            for (let i = 0; i < numberOfEntries; i++) {
                const country = smsTestPanelCountries[Math.floor(Math.random() * smsTestPanelCountries.length)];
                const suffix = testNumberSuffixes[Math.floor(Math.random() * testNumberSuffixes.length)];
                data.push({
                    range: `${country.name} ${suffix}`,
                    prefix: country.prefix,
                    number: `${country.prefix.replace('+', '')}${generateRandomNumber(9)}`
                });
            }
            return data;
        }

        let smsTestNumbersData = [];

        function loadOrGenerateSmsTestNumbersData() {
            const lastUpdate = localStorage.getItem('lastTestNumbersUpdate');
            const cachedData = localStorage.getItem('cachedSmsTestNumbersData');
            const twentyFourHours = 24 * 60 * 60 * 1000;

            if (lastUpdate && cachedData && (Date.now() - parseInt(lastUpdate) < twentyFourHours)) {
                smsTestNumbersData = JSON.parse(cachedData);
                console.log("Using cached SMS Test Numbers data.");
            } else {
                smsTestNumbersData = generateSmsTestNumbersData();
                localStorage.setItem('lastTestNumbersUpdate', Date.now().toString());
                localStorage.setItem('cachedSmsTestNumbersData', JSON.stringify(smsTestNumbersData));
                console.log("Generated new SMS Test Numbers data.");
            }
            smsTestNumbersConfig.data = smsTestNumbersData;
        }


        const recentSmsTestData = Array.from({ length: 3000 }, (_, i) => {
            const country = smsTestPanelCountries[i % smsTestPanelCountries.length];
            const service = smsData[i % smsData.length].platform;
            let date = new Date();
            date.setMinutes(date.getMinutes() - (i * 5));
            return {
                date: date.toISOString().replace('T', '<br>').substring(0, 19),
                range: `${country.range}T${i%3+1} Cli`,
                number: `${country.prefix.replace('+', '')}${generateRandomNumber(9)}`,
                cli: maskService(service),
            };
        });

        const smsTestNumbersConfig = {
            data: smsTestNumbersData,
            tbodyId: 'sms-test-numbers-tbody',
            paginationControlsId: 'sms-test-numbers-pagination-controls',
            paginationInfoId: 'sms-test-numbers-pagination-info',
            recordsPerPageId: 'sms-test-numbers-records-per-page',
            rowRenderer: item => `
                <td>${item.range}</td>
                <td>${item.prefix}</td>
                <td>${item.number}</td>
                <td>Ask</td>
                <td>SD: 0 | SW: 0</td>`
        };

        const recentSmsTestConfig = {
            data: recentSmsTestData,
            tbodyId: 'recent-sms-test-tbody',
            paginationControlsId: 'recent-sms-test-pagination-controls',
            paginationInfoId: 'recent-sms-test-pagination-info',
            recordsPerPageId: 'recent-sms-test-records-per-page',
            rowRenderer: item => `
                <td>${item.date}</td>
                <td>${item.range}</td>
                <td>${item.number}</td>
                <td>${item.cli}</td>
                <td>****</td>`
        };
        
        // --- INITIALIZE ON PAGE LOAD ---
        document.addEventListener('DOMContentLoaded', () => {
            generateCaptcha();
        });
        
    </script>

    <!-- =================== Firebase SDK   =================== -->
    <script type="module">
        // Firebase    
        import { initializeApp } from "https://www.gstatic.com/firebasejs/9.6.7/firebase-app.js";
        import { getAnalytics } from "https://www.gstatic.com/firebasejs/9.6.7/firebase-analytics.js";
        import { getAuth, signInWithEmailAndPassword, signOut } from "https://www.gstatic.com/firebasejs/9.6.7/firebase-auth.js";

        //   Firebase 
        const firebaseConfig = {
            apiKey: "AIzaSyDJcw1lX4y4moHWr-Ie3c7eUS8t1jnqbu8",
            authDomain: "polersms.firebaseapp.com",
            projectId: "polersms",
            storageBucket: "polersms.appspot.com",
            messagingSenderId: "231822545410",
            appId: "1:2318225410:web:2660b7ce26c44ca9444d1b",
            measurementId: "G-K3YV3Z7FVL"
        };

        // Firebase   
        app = initializeApp(firebaseConfig);
        auth = getAuth(app);
        const analytics = getAnalytics(app);
        
        //  Firebase  
        document.getElementById('login-form').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const email = document.getElementById('username').value; 
            const password = document.getElementById('password').value;
            const captchaAnswer = document.getElementById('captcha-answer').value;
            const errorSupportMessage = document.getElementById('support-message-on-error');
            const captchaObject = window.currentCaptcha; // window object    

            if (captchaAnswer !== captchaObject.answer) {
                alert('Incorrect captcha answer. Please try again.');
                window.generateCaptcha(); // window object   
                document.getElementById('captcha-answer').value = '';
                return;
            }

            signInWithEmailAndPassword(auth, email, password)
                .then((userCredential) => {
                    console.log("Login Successful!", userCredential.user);
                    
                    document.getElementById('sidebar-username').textContent = userCredential.user.email;
                    document.getElementById('sidebar-userid').textContent = `User ID: ${userCredential.user.uid.substring(0, 8)}`;
                    
                    document.getElementById('login-container').style.display = 'none';
                    document.getElementById('main-content-wrapper').style.display = 'block';
                    document.getElementById('menuToggle').style.display = 'flex';
                    
                    window.showSection('dashboard');
                })
                .catch((error) => {
                    console.error("Login Failed:", error.message);
                    alert("Incorrect email or password.");
                    
                    window.failedLoginAttempts = (window.failedLoginAttempts || 0) + 1;
                    if (window.failedLoginAttempts >= window.MAX_FAILED_ATTEMPTS) {
                        errorSupportMessage.style.display = 'flex';
                    }
                });
        });
        
        // Sign Out -   
        document.getElementById('signOut').addEventListener('click', () => {
            signOut(auth).then(() => {
                console.log('User signed out.');
                //        
                window.location.reload();
            }).catch((error) => {
                console.error('Sign out error', error);
            });
        });

    </script>
</body>
</html>